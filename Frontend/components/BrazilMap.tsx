import React from 'react';

interface BrazilMapProps {
  title: string;
  data: { [stateCode: string]: number };
}

export const BrazilMap: React.FC<BrazilMapProps> = ({ title, data }) => {
  const numericValues = Object.values(data).filter((v): v is number => typeof v === 'number' && Number.isFinite(v));
  const maxValue = numericValues.length ? Math.max(...numericValues) : 0;
  const minValue = numericValues.length ? Math.min(...numericValues) : 0;

  const getColor = (value: number | undefined) => {
    if (value === undefined) return '#e2e8f0'; // Default color for states with no data
    if (maxValue === minValue) return 'hsl(195, 65%, 50%)'; // Return a mid-range color if all values are the same
    const ratio = (value - minValue) / (maxValue - minValue) || 0;
    const lightness = 90 - ratio * 50; 
    // Using HSL color for dynamic shading of the brand color
    const hue = 195; // #42B0D5 hue
    const saturation = 65;
    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
  };

  const states: { [key: string]: { path: string, name: string } } = {
    'AC': { name: 'Acre', path: 'M133.2,357.55l-3.37-0.33l-3.34-1.63l-2.86-2.55l-2.6-2.92l-1.82-2.97l-0.82-3.4l0.49-3.6l0.33-4.2l-0.82-3.6l-1.14-2.78l-1.96-2.83l-2.94-2.65l-3.27-1.75l-3.43-1.46l-3.43-0.85l-3.84-0.16l-4.25,0.65l-3.27,1.32l-3.43,2.2l-2.78,2.33l-2.78,2.48l-2.12,2.62l-3.92,1.46l0.33,1.18l-3.51,1.46l-0.16,2.81l-4.99,3.6l-0.82,2.29l0.16,3.13l0.33,2.81l1.76,1.62l-0.16,1.78l1.14,2.2l2.94,0.79l2.65,1.62l-0.33,2.62l-0.16,3.55l2.62,1.94l2.81,1.76l2.29,2.69l1.66,3.13l-0.16,2.62l0.49,2.96l2.81,1.78l3.6,2.29l2.81,1.62l1.46,2.78l3.11,2.12l1.78,3.6l2.12,1.46l2.81,1.32l3.13,1.14l3.79,0.49l3.79,0l2.96-0.99l3.29-1.46l2.12-1.8l2.62-1.8l1.96-3.13l2.96-2.33l2.29-2.52l2.12-2.12l1.96-3.51l0.79-3.29l1.14-2.62l0.65-3.13v-3.43l1.78-2.12l1.96-2.81l0.65-3.45v-2.52l0.99-2.62l2.45-2.19l3.89-2.17l-0.33-2.62l1.32-2.62l2.12-1.85l1.96-2.62l2.29-1.62l1.62-3.13l0.79-3.29l1.94-2.59l2.62-2.19l2.96-1.85l2.81-1.62l2.96-1.63l3.29-1.76l1.82-2.81l1.8-2.81l1.46-3.13l0.79-3.51l0.33-4.2l-0.49-3.6l-0.99-2.81l-1.96-2.65l-3.11-2.29l-3.29-1.76l-3.45-1.46l-3.45-1.14l-3.92-0.82l-3.59-0.16l-3.59,0.65l-3.29,1.32l-3.45,1.8l-2.81,2.33l-2.81,2.48l-2.12,2.62l-1.8,0.33l-2.12-0.82' },
    'AL': { name: 'Alagoas', path: 'M481.56,410.3l0.49-2.65l0.16-3.43l0.99-2.96l1.14-2.48l1.94-2.29l2.45-1.65l2.62-0.79l3.29,0l2.75,1.28l2.62,2.12l2.09,2.48l1.75,1.5l0.49,0.16l-0.79,2.17l-0.16,3.6l-0.49,2.81l-0.33,3.13l-0.79,2.69l-0.99,2.99l-1.76,2.29l-2.29,2.0l-2.45,0.95l-2.29-0.16l-2.62-1.14l-2.45-1.65l-2.24-2.29l-1.62-2.69l-1.32-2.99l-0.16-2.97' },
    'AP': { name: 'Amapá', path: 'M344.38,206.56l-0.49-3.06l-0.16-3.38l0.65-3.27l1.01-2.73l1.39-2.62l1.8-2.3l1.88-2.06l1.83-1.88l1.64-1.38l1.51-1.19l1.2-0.95l1.01-0.8l0.33-0.95l-0.16-1.14l-0.86-1.32l-1.32-1.11l-1.67-1.04l-1.83-0.66l-1.99-0.33l-2.17-0.33l-2.19,0l-2.52,0.16l-2.78,0.66l-2.45,1.24l-2.14,1.8l-2.65,2.57l-2.17,3.21l-1.67,3.38l-1.2,3.55l-1.54,3.86l-0.86,3.95l-0.69,4.03l-0.69,3.86l0.34,3.38l1.19,2.69l1.7,2.2l2.37,1.7l2.84,1.24l3.18,0.66l3.34,0l3.0, -0.66l2.67, -1.24l2.2, -1.7l1.54, -2.03l1.04, -2.54l0.34, -3.06' },
    'AM': { name: 'Amazonas', path: 'M253.11,353.46l-2.3,2.48l-2.45,2.29l-3.27,1.96l-3.11,1.46l-3.59,0.82l-3.92,0.16l-4.25-0.65l-3.92-1.46l-3.59-1.96l-3.27-2.62l-2.94-2.94l-2.78-3.76l-2.12-3.92l-1.46-4.09l-1.14-4.58l-0.65-4.9l0.16-4.74l0.82-4.41l1.8-4.09l2.45-3.59l2.94-3.11l3.59-2.29l3.92-1.63l4.25-0.99l4.41-0.33l4.58,0.49l4.58,1.32l4.25,2.12l3.92,2.94l3.43,3.76l2.94,4.25l2.29,4.58l1.63,4.9l0.99,5.07l0.49,5.07l-0.65,4.74l-1.46,4.41l-2.29,4.09l-3.11,3.59l-3.76,2.94l-4.41,2.12l-4.9,1.32l-5.39,0.33l-5.39-0.49l-4.9-1.32l-4.25-1.96l-3.59-2.62l-2.94-3.11l-2.29-3.59l-1.63-4.09l-0.99-4.58l-0.33-4.9l0.49-4.74l1.32-4.41l2.12-4.09l2.94-3.59l3.59-2.94l4.25-2.29l4.9-1.46l5.39-0.65l5.56,0.16l5.39,0.99l4.9,1.8l4.25,2.62l3.59,3.27l2.94,3.92l2.29,4.41l1.46,4.9l0.82,5.23l0.33,5.23l2.78,0l0,1.28l-0.16,2.96l-0.65,2.81l-1.46,2.62l-2.12,2.29l-2.45,1.62l-2.94,1.14l-3.27,0.49l-3.59-0.16l-3.43-0.99l-3.11-1.8l-2.62-2.45l-2.29-2.94l-1.63-3.29l-0.82-3.6l-0.16-3.92l0.65-3.76l1.32-3.43l1.96-3.11l2.62-2.62l3.11-1.96l3.43-1.14l3.59-0.65l3.76,0.16l3.43,0.82l3.11,1.63l2.62,2.29l2.12,2.78l1.46,3.27l0.82,3.76l0.33,4.09l-2.78,0' },
    'BA': { name: 'Bahia', path: 'M446.52,479.79l-1.62-2.96l-1.8-2.62l-2.12-2.81l-1.96-2.96l-1.8-2.98l-1.46-3.11l-1.14-3.27l-0.65-3.43l-0.16-3.59l0.33-3.59l0.99-3.29l1.46-3.11l1.8-2.62l2.12-2.29l2.45-1.94l2.62-1.46l2.81-0.99l2.96, -0.33l3.11,0l2.96,0.99l2.62,1.63l2.29,2.24l1.96,2.62l1.46,2.96l0.99,3.24l0.49,3.51l0,3.71l-0.65,3.59l-1.32,3.24l-1.8,2.81l-2.29,2.33l-2.62,1.8l-2.96,1.32l-3.11,0.65l-3.29,0l-1.94-25.5' },
    'CE': { name: 'Ceará', path: 'M461.94,300.74l2.12,2.48l2.48,2.17l2.81,1.63l3.13,1.11l3.29,0.32l3.29-0.32l3.13-1.11l2.81-1.8l2.48-2.33l2.12-2.78l1.63-3.11l1.11-3.43l0.82-3.59l0.32-3.76l-0.32-3.59l-0.98-3.27l-1.63-2.96l-2.24-2.48l-2.81-1.96l-3.29-1.28l-3.59-0.63l-3.76-0.16l-3.59,0.48l-3.29,1.11l-2.96,1.8l-2.48,2.48l-1.96,2.96l-1.43,3.43l-0.98,3.76l-0.63,3.92l0.16,3.76l0.82,3.43l1.43,2.96l2.12,2.48l2.81,1.96l3.29,1.28l3.59,0.63l2.48-0.16l2.29-0.48l2.12-1.11l1.8-1.63l1.32-1.96l0.82-2.12l0.16-2.3l-0.49-2.3l-1.14-2.12l-1.8-1.8l-2.12-1.28l-2.48-0.63l-2.48,0l-2.48,0.63l-2.12,1.28l-1.8,1.63l-1.14,1.96l-0.63,2.48l0.16,2.48l0.82,2.3l1.43,1.96l1.8,1.63l2.12,1.11l2.3,0.48l2.3-0.16l2.12-0.63l1.96-1.28l1.43-1.63l0.98-1.96l0.32-2.12l-0.32-2.3l-0.98-2.12l-1.43-1.8l-1.96-1.28l-2.3-0.63l-2.48,0.16l-2.3,0.63l-1.96,1.28l-1.63,1.8l-1.11,2.12l-0.63,2.3l0.16,2.48l0.98,2.3l1.43,1.96l1.96,1.63l2.3,1.11l2.48,0.48l2.48-0.16l2.3-0.82l1.96-1.43l1.43-1.8l0.98-2.12l0.48-2.48l-0.16-2.6l-0.98-2.48l-1.63-2.12l-2.12-1.63l-2.6-1.11l-2.96-0.48l-3.29,0.16l-3.13,0.82l-2.81,1.43l-2.3,1.96l-1.8,2.3l-1.28,2.6l-0.82,2.96l-0.32,3.29l0.32,3.43l0.98,3.13l1.63,2.81l2.12,2.3l2.81,1.8l3.13,1.11l3.43,0.48l3.43-0.16l3.29-0.82l2.96-1.43l2.48-1.96l1.96-2.48l1.43-2.81l0.98-3.13l0.48-3.43l-0.16-3.59l-0.82-3.29l-1.43-2.96l-2.12-2.48l-2.81-1.8l-3.29-1.28l-3.59-0.48l-3.76,0.16l-3.59,0.82l-3.29,1.43l-2.81,1.96l-2.3,2.48l-1.8,2.96l-1.28,3.29l-0.82,3.59l-0.32,3.76l0.48,3.59l1.11,3.29l1.8,2.81l2.48,2.3l2.96,1.8l3.43,1.11l3.76,0.32l3.76-0.16l3.59-0.82l3.29-1.43l2.81-1.96l2.3-2.48l1.8-2.81l1.28-3.13l0.82-3.43l0.32-3.59l-0.32-3.76l-0.98-3.43l-1.63-2.96l-2.3-2.48l-2.81-1.96l-3.29-1.28l-3.59-0.48l-3.76,0l-3.76,0.63l-3.43,1.28l-2.96,1.96l-2.48,2.48l-1.96,2.96l-1.43,3.43l-0.98,3.76l-0.48,3.92l0.32,3.76l0.98,3.43l1.63,2.96l2.3,2.48l2.96,1.96l3.43,1.28l3.76,0.48l3.92,0l3.76-0.63l3.43-1.28l2.96-1.96l2.48-2.48l1.96-2.96l1.43-3.43l0.98-3.76l0.48-3.92l-0.16-3.92l-0.82-3.76l-1.43-3.43l-2.12-2.96l-2.81-2.48l-3.29-1.96l-3.59-1.28l-3.76-0.48l-3.92,0.16l-3.76,0.82l-3.43,1.43l-2.96,1.96l-2.48,2.48l-1.96,2.96l-1.43,3.43l-0.98,3.76l-0.48,3.92l0.16,3.92l0.82,3.76l1.43,3.43l2.12,2.96l2.81,2.48l3.29,1.96l3.59,1.28l3.76,0.48l3.92-0.16l3.76-0.82l3.43-1.43l2.96-1.96l2.48-2.48l1.96-2.96l1.43-3.43l0.98-3.76l0.48-3.92l-0.16-3.92l-0.82-3.76l-1.43-3.43l-2.12-2.96l-2.81-2.48l-3.29-1.96l-3.59-1.28l-3.76-0.48l-3.92,0l-3.92,0.63l-3.59,1.28l-3.13,1.96l-2.6,2.48l-2.12,2.96l-1.63,3.43l-1.11,3.76l-0.63,3.92l-0.16,4.08l0.63,3.92l1.28,3.76l1.96,3.43l2.6,2.96l3.29,2.48l3.76,1.96l4.24,1.28l4.56,0.48l4.72-0.16l4.56-0.82l4.24-1.43l3.76-1.96l3.29-2.48l2.81-2.96l2.3-3.43l1.8-3.76l1.28-3.92l0.82-4.24l0.32-4.4l-0.32-4.4l-0.98-4.24l-1.63-3.92l-2.3-3.59l-2.96-3.13l-3.59-2.6l-4.08-1.96l-4.4-1.28l-4.72-0.48l-4.88,0.16l-4.72,0.82l-4.4,1.43l-3.92,1.96l-3.43,2.48l-2.96,2.96l-2.48,3.43l-1.96,3.76l-1.43,4.08l-0.98,4.24l-0.48,4.4l0.16,4.4l0.82,4.24l1.43,3.92l1.96,3.59l2.48,3.13l2.96,2.6l3.43,1.96l3.92,1.28l4.4,0.63l4.72-0.16l4.88-0.82l4.72-1.43l4.4-1.96l3.92-2.48l3.43-2.96l2.96-3.43l2.48-3.76l1.96-4.08l1.43-4.24l0.98-4.4l0.48-4.4l-0.16-4.4l-0.82-4.24l-1.43-3.92l-1.96-3.59l-2.48-3.13l-2.96-2.6l-3.43-1.96l-3.92-1.28l-4.4-0.63l-4.72,0l-4.88,0.63l-4.72,1.28l-4.4,1.96l-3.92,2.6l-3.43,3.13l-2.96,3.59l-2.48,3.92l-1.96,4.24l-1.43,4.4l-0.98,4.4l-0.48,4.4l0.16,4.4l0.82,4.24l1.43,3.92l1.96,3.59l2.48,3.13l2.96,2.6l3.43,1.96l3.92,1.28l4.4,0.63l4.72,0l4.88-0.63l4.72-1.28l4.4-1.96l3.92-2.6l3.43-3.13l2.96-3.59l2.48-3.92l1.96-4.24l1.43-4.4l0.98-4.4l0.48-4.4l-0.16-4.4l-0.82-4.24l-1.43-3.92l-1.96-3.59l-2.48-3.13l-2.96-2.6l-3.43-1.96l-3.92-1.28l-4.4-0.63l-4.72,0l-4.88,0.63l-4.72,1.28l-4.4,1.96l-3.92,2.6l-3.43,3.13l-2.96,3.59l-2.48,3.92l-1.96,4.24l-1.43,4.4l-0.98,4.4l-0.48,4.4l0.16,4.4l0.82,4.24l1.43,3.92l1.96,3.59l2.48,3.13l2.96,2.6l3.43,1.96l3.92,1.28l4.4,0.63l4.72,0l4.88-0.63l4.72-1.28l4.4-1.96l3.92-2.6l3.43-3.13l2.96-3.59l2.48-3.92l1.96-4.24l1.43-4.4l0.98-4.4l0.48-4.4l-0.16-4.4l-0.82-4.24l-1.43-3.92l-1.96-3.59l-2.48-3.13l-2.96-2.6l-3.43-1.96l-3.92-1.28l-4.4-0.63l-4.72,0l-4.88,0.63l-4.72,1.28l-4.4,1.96l-3.92,2.6l-3.43,3.13l-2.96,3.59l-2.48,3.92l-1.96,4.24l-1.43,4.4l-0.98,4.4l-0.48,4.4l0.16,4.4l0.82,4.24l1.43,3.92l1.96,3.59l2.48,3.13l2.96,2.6l3.43,1.96l3.92,1.28l4.4,0.63l4.72,0l4.88-0.63l4.72-1.28l4.4-1.96l3.92-2.6l3.43-3.13l2.96-3.59l2.48-3.92l1.96-4.24l1.43-4.4l0.98-4.4l0.48-4.4l-0.16-4.4l-0.82-4.24l-1.43-3.92l-1.96-3.59l-2.48-3.13l-2.96-2.6l-3.43-1.96l-3.92-1.28l-4.4-0.63l-4.72,0l-4.88,0.63l-4.72,1.28l-4.4,1.96l-3.92,2.6l-3.43,3.13l-2.96,3.59l-2.48,3.92l-1.96,4.24l-1.43,4.4l-0.98,4.4l-0.48,4.4l0.16,4.4l0.82,4.24l1.43,3.92l1.96,3.59l2.48,3.13l2.96,2.6l3.43,1.96l3.92,1.28l4.4,0.63l4.72,0l4.88-0.63l4.72-1.28l4.4-1.96l3.92-2.6l3.43-3.13l2.96-3.59l2.48-3.92l1.96-4.24l1.43-4.4l0.98-4.4l0.48-4.4l-0.16-4.4l-0.82-4.24l-1.43-3.92l-1.96-3.59l-2.48-3.13l-2.96-2.6l-3.43-1.96l-3.92-1.28l-4.4-0.63l-4.72,0l-4.88,0.63l-4.72,1.28l-4.4,1.96l-3.92,2.6l-3.43,3.13l-2.96,3.59l-2.48,3.92l-1.96,4.24l-1.43,4.4l-0.98,4.4l-0.48,4.4l0.16,4.4l0.82,4.24l1.43,3.92l1.96,3.59l2.48,3.13l2.96,2.6l3.43,1.96l3.92,1.28l4.4,0.63l4.72,0l4.88-0.63l4.72-1.28l4.4-1.96l3.92-2.6l3.43-3.13l-2.12-2.3l-2.12-2.48l-2.3-2.62l-2.48-2.62l-2.62-2.48l-2.81-2.3l-2.96-1.96l-3.13-1.63l-3.29-1.28l-3.43-0.82l-3.59-0.32l-3.59,0.32l-3.43,0.82l-3.29,1.28l-3.13,1.63l-2.96,1.96l-2.81,2.3l-2.62,2.48l-2.48,2.62l-2.3,2.62l-2.12,2.48l-2.12,2.3l-1.96,2.12' },
  };

  return (
    <div className="my-4 relative">
      <h4 className="font-semibold text-slate-700 mb-2">{title}</h4>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 600 600"
        className="w-full h-auto"
        aria-labelledby="title"
        role="img"
      >
        <title id="title">{title}</title>
        <g id="brazil-map">
          {Object.entries(states).map(([stateCode, stateInfo]) => (
            <path
              key={stateCode}
              d={stateInfo.path}
              fill={getColor(data[stateCode])}
              stroke="#FFFFFF"
              strokeWidth="0.5"
            >
              <title>{`${stateInfo.name}: ${data[stateCode]?.toLocaleString() ?? 'No data'}`}</title>
            </path>
          ))}
        </g>
      </svg>
    </div>
  );
};

export default BrazilMap;
